(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{qLZO:function(t,e,i){"use strict";i.r(e),i.d(e,"DeckModule",(function(){return _}));var n=i("tyNb"),r=i("/vdw");const o=t=>({attribute:t,moving:!1,cardMoveAreas:null,createCardTo:function(){const t=document.createElement("div");return t.classList.add("card-to"),t},itemMouseDown:function(t){if(1===t.which)if(t.target.parentElement.hasAttribute("insert-mode"))this.moving=!1;else{if(this.moving=!0,t.target.parentElement.hasAttribute("extract-mode")){const e=t.target.cloneNode(!0);e.addEventListener("mousedown",this.itemMouseDown.bind(this)),t.target.parentElement.insertBefore(e,t.target.nextSibling)}t.target.addEventListener("mousemove",this.itemMouseMove.bind(this)),t.target.addEventListener("mouseup",this.itemMouseUp.bind(this)),t.target.style.top=t.target.getBoundingClientRect().top+"px",t.target.style.left=t.target.getBoundingClientRect().left+"px",t.target.style.position="fixed",t.target.style.zIndex=10}},itemMouseMove:function(t){if(this.moving){t.target.style.top=t.y-t.target.clientHeight/2+"px",t.target.style.left=t.x-t.target.clientWidth/2+"px";const e=document.elementsFromPoint(t.clientX,t.clientY).find(e=>e.hasAttribute(this.attribute+"-item")&&e.getAttribute(this.attribute+"-item-id")!==t.target.getAttribute(this.attribute+"-item-id")||e.classList.contains("card-to"));if(e)e.parentElement.hasAttribute("extract-mode")||e.classList.contains("card-to")||(document.querySelectorAll(".card-to").forEach(t=>t.remove()),e.parentElement.insertBefore(this.createCardTo(),e));else{const e=document.elementsFromPoint(t.clientX,t.clientY).find(t=>t.hasAttribute(this.attribute));document.querySelectorAll(".card-to").forEach(t=>t.remove()),e&&!e.hasAttribute("extract-mode")&&e.appendChild(this.createCardTo())}}},itemMouseUp:function(t){if(this.moving){t.target.removeEventListener("mousemove",t=>this.itemMouseMove),t.target.removeEventListener("mouseup",t=>this.itemMouseUp);const e=document.elementsFromPoint(t.clientX,t.clientY).find(t=>t.hasAttribute(this.attribute)),i={from:null,to:null};let n=!1;if(e)if(e.hasAttribute("extract-mode"))n=!0;else{const n=document.elementsFromPoint(t.clientX,t.clientY).find(e=>e.classList.contains("card-to")||e.hasAttribute(this.attribute+"-item")&&e.getAttribute(this.attribute+"-item-id")!=t.target.getAttribute(this.attribute+"-item-id"));t.target.setAttribute(this.attribute+"-id",e.getAttribute(this.attribute+"-id")),i.from=t.target.parentElement,n?e.insertBefore(t.target,n):e.appendChild(t.target),i.to=t.target.parentElement}else t.target.parentElement.hasAttribute("extract-mode")&&(n=!0);t.target.style.removeProperty("top"),t.target.style.removeProperty("left"),t.target.style.removeProperty("position"),t.target.style.removeProperty("z-index"),i.from&&i.to&&(this.reorderAreaIds(i.from),this.reorderAreaIds(i.to),i.from.getAttribute(this.attribute+"-id")===i.to.getAttribute(this.attribute+"-id")?this.doEvents.moveSameArea(this,i.to):this.doEvents.moveDifferentAreas(this,i.from,i.to)),n&&t.target.remove(),document.querySelectorAll(".card-to").forEach(t=>t.remove()),this.moving=!1}},reorderAreaIds:function(t){for(let e=0;e<t.children.length;e++)t.children[e].setAttribute(this.attribute+"-item-id",`${t.getAttribute(this.attribute+"-id")}-${e}`)},initArea:function(t,e,i){for(let n=0;n<e.children.length;n++){const r=e.children[n];r.hasAttribute(this.attribute+"-item")||(r.setAttribute(this.attribute+"-item",!0),r.setAttribute(this.attribute+"-id",i),r.setAttribute(this.attribute+"-item-id",`${i}-${n}`),r.addEventListener("mousedown",t.itemMouseDown.bind(t)))}},initCardMove:function(t){t.cardMoveAreas=document.querySelectorAll("["+t.attribute+"]"),t.cardMoveAreas.forEach((e,i)=>{e.setAttribute(this.attribute+"-id",i),t.initArea(t,e,i)}),t.doEvents.init(t)},events:{init:null,moveSameArea:null,moveDifferentAreas:null},doEvents:{init:t=>{t.events.init&&t.events.init()},moveSameArea:(t,e)=>{t.events.moveSameArea&&t.events.moveSameArea(e)},moveDifferentAreas:(t,e,i)=>{t.events.moveDifferentAreas&&t.events.moveDifferentAreas(e,i)}}});var c=i("IzEk"),a=i("fXoL"),s=i("QJME"),d=i("sm2E"),l=i("e0Ib"),b=i("ofXK"),u=i("h3Nf");const m=function(t){return{backgroundImage:t}};function h(t,e){if(1&t){const t=a.Lb();a.Kb(0,"div",5),a.Rb("mouseenter",(function(){a.ac(t);const i=e.$implicit;return a.Tb().cardHover.emit(i)})),a.Jb()}2&t&&a.Wb("ngStyle",a.Yb(1,m,"url("+e.$implicit.card_images[0].image_url_small+")"))}function g(t,e){if(1&t){const t=a.Lb();a.Kb(0,"div",5),a.Rb("mouseenter",(function(){a.ac(t);const i=e.$implicit;return a.Tb().cardHover.emit(i)})),a.Jb()}2&t&&a.Wb("ngStyle",a.Yb(1,m,"url("+e.$implicit.card_images[0].image_url_small+")"))}function p(t,e){if(1&t){const t=a.Lb();a.Kb(0,"div",5),a.Rb("mouseenter",(function(){a.ac(t);const i=e.$implicit;return a.Tb().cardHover.emit(i)})),a.Jb()}2&t&&a.Wb("ngStyle",a.Yb(1,m,"url("+e.$implicit.card_images[0].image_url_small+")"))}let v=(()=>{class t{constructor(){this.cardHover=new a.n}ngOnInit(){}getMainCardsInfo(t){const e=t.filter(t=>t.type.includes("Monster")).length,i=t.filter(t=>t.type.includes("Spell")||t.type.includes("Skill")).length,n=t.filter(t=>t.type.includes("Trap")).length;return`${t.length} [ Monstros: ${e}, Magia: ${i}, Armadilha: ${n} ]`}getExtraCardsInfo(t){const e=t.filter(t=>t.type.includes("Fusion")).length,i=t.filter(t=>t.type.includes("Spell")||t.type.includes("XYZ")).length,n=t.filter(t=>t.type.includes("Synchro")).length,r=t.filter(t=>t.type.includes("Link")).length;return`${t.length} [ Fus\xe3o: ${e}, XYZ: ${i}, Sincro: ${n}, Link: ${r} ]`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Bb({type:t,selectors:[["app-active-deck"]],inputs:{deck:"deck"},outputs:{cardHover:"cardHover"},decls:25,vars:6,consts:[[1,"deck-container"],[1,"deck-section"],[1,"deck-header"],["card-move-area","",1,"deck-cards"],["class","card-move",3,"ngStyle","mouseenter",4,"ngFor","ngForOf"],[1,"card-move",3,"ngStyle","mouseenter"]],template:function(t,e){1&t&&(a.Kb(0,"div",0),a.Kb(1,"section",1),a.Kb(2,"div",2),a.Kb(3,"span"),a.ec(4,"Main"),a.Jb(),a.Kb(5,"span"),a.ec(6),a.Jb(),a.Jb(),a.Kb(7,"div",3),a.dc(8,h,1,3,"div",4),a.Jb(),a.Jb(),a.Kb(9,"section",1),a.Kb(10,"div",2),a.Kb(11,"span"),a.ec(12,"Extra"),a.Jb(),a.Kb(13,"span"),a.ec(14),a.Jb(),a.Jb(),a.Kb(15,"div",3),a.dc(16,g,1,3,"div",4),a.Jb(),a.Jb(),a.Kb(17,"section",1),a.Kb(18,"div",2),a.Kb(19,"span"),a.ec(20,"Apoio"),a.Jb(),a.Kb(21,"span"),a.ec(22),a.Jb(),a.Jb(),a.Kb(23,"div",3),a.dc(24,p,1,3,"div",4),a.Jb(),a.Jb(),a.Jb()),2&t&&(a.xb(6),a.fc(e.getMainCardsInfo(e.deck.main)),a.xb(2),a.Wb("ngForOf",e.deck.main),a.xb(6),a.fc(e.getExtraCardsInfo(e.deck.extra)),a.xb(2),a.Wb("ngForOf",e.deck.extra),a.xb(6),a.fc(e.getMainCardsInfo(e.deck.side)),a.xb(2),a.Wb("ngForOf",e.deck.side))},directives:[b.i,b.k],styles:["*[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none}.deck-container[_ngcontent-%COMP%]{width:100%}.deck-container[_ngcontent-%COMP%], .deck-section[_ngcontent-%COMP%]{border:1px solid #000}.deck-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:5px 5px 0}.deck-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(13,1fr);gap:5px;padding:5px}.deck-cards[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto}.card-move[_ngcontent-%COMP%], .card-to[_ngcontent-%COMP%]{width:56.61px!important;height:82.89px!important}"]}),t})();var f=i("3Pt+"),y=i("cp0P");const k=["container"];function x(t,e){if(1&t&&(a.Kb(0,"div",14),a.ec(1),a.Jb()),2&t){const t=a.Tb();a.Wb("ngStyle",t.getShadowStyle()),a.xb(1),a.fc(t.loadingText)}}const C=function(t){return{backgroundImage:t}};function M(t,e){if(1&t){const t=a.Lb();a.Kb(0,"div",15),a.Rb("mouseenter",(function(){a.ac(t);const i=e.$implicit;return a.Tb().cardHover.emit(i)})),a.Kb(1,"div",16),a.Ib(2,"div",17),a.Jb(),a.Kb(3,"div",18),a.Kb(4,"p"),a.Kb(5,"span"),a.ec(6,"Nome:"),a.Jb(),a.ec(7),a.Jb(),a.Kb(8,"p"),a.Kb(9,"span"),a.ec(10,"Tipo:"),a.Jb(),a.ec(11),a.Jb(),a.Jb(),a.Jb()}if(2&t){const t=e.$implicit;a.xb(2),a.Wb("ngStyle",a.Yb(3,C,"url("+t.card_images[0].image_url_small+")")),a.xb(5),a.gc(" ",t.name,""),a.xb(4),a.gc(" ",t.type,"")}}let w=(()=>{class t{constructor(t){this.ygoprodeckService=t,this.cardClick=new a.n,this.cardHover=new a.n,this.searchEvent=new a.n,this.cardList=[],this.loading=!1,this.loadingText="",this.displayMode="list",this.search=new f.c("dragao"),this.sortBy=new f.c("name")}ngOnInit(){this.sortBy.valueChanges.subscribe(()=>{this.sortCards()})}keyUp(t){"NumpadEnter"!==t.code&&"Enter"!==t.code||this.getCards()}getCards(){this.loading=!0,this.loadingText="Buscando cartas...",this.ygoprodeckService.fname(this.search.value).pipe(Object(c.a)(1)).subscribe(t=>{this.cardList=[];const e=[];t.data.forEach(t=>{t.card_images.length>1?t.card_images.forEach(t=>{e.push(this.ygoprodeckService.id(t.id))}):this.cardList.push(t)}),e.length?(this.loadingText="Buscando varia\xe7\xf5es de cartas...",this.getVariations(e,()=>{this.loading=!1,this.searchEvent.emit("done"),this.sortCards()})):(this.loading=!1,this.searchEvent.emit("done"),this.sortCards())})}getVariations(t,e){Object(y.a)(t.splice(0,10)).pipe(Object(c.a)(1)).subscribe(i=>{this.cardList=this.cardList.concat(i.map(t=>t.data[0])),t.length?setTimeout(()=>{this.getVariations(t,e)},1e3):e()})}sortCards(){const t=this.sortBy.value.replace("-","");this.sortBy.value.includes("-")?this.cardList.sort((e,i)=>i[t].localeCompare(e[t])):this.cardList.sort((e,i)=>e[t].toString().localeCompare(i[t]))}getStyle(){return this.container?{height:this.container.nativeElement.offsetHeight-80+"px"}:{display:"none"}}handleClick(t,e){e?this.ygoprodeckService.id(e.id).pipe(Object(c.a)(1)).subscribe(t=>{console.log(t),t.data.length&&this.cardClick.emit(t.data[0])}):this.cardClick.emit(t)}enterImageVariation(t,e){const i=JSON.parse(JSON.stringify(t));i.card_images=i.card_images.filter(t=>t.id===e.id),this.cardHover.emit(i)}getShadowStyle(){return this.container?{width:this.container.nativeElement.getBoundingClientRect().width+"px",height:this.container.nativeElement.getBoundingClientRect().height+"px"}:{display:"none"}}}return t.\u0275fac=function(e){return new(e||t)(a.Hb(s.a))},t.\u0275cmp=a.Bb({type:t,selectors:[["app-card-search-move"]],viewQuery:function(t,e){var i;1&t&&a.ic(k,!0),2&t&&a.Zb(i=a.Sb())&&(e.container=i.first)},inputs:{moveattribute:"moveattribute"},outputs:{cardClick:"cardClick",cardHover:"cardHover",searchEvent:"searchEvent"},decls:20,vars:4,consts:[[1,"container"],["container",""],["class","container-shadow",3,"ngStyle",4,"ngIf"],[1,"search"],["type","text",3,"formControl","keyup"],[3,"click"],[3,"formControl"],["value","name"],["value","-name"],["value","type"],["value","-type"],[1,"results"],[1,"card-list"],["class","card-list-item",3,"mouseenter",4,"ngFor","ngForOf"],[1,"container-shadow",3,"ngStyle"],[1,"card-list-item",3,"mouseenter"],["card-move-area","","extract-mode",""],[1,"card-move",3,"ngStyle"],[1,"card-list-item-info"]],template:function(t,e){1&t&&(a.Kb(0,"div",0,1),a.dc(2,x,2,2,"div",2),a.Kb(3,"div",3),a.Kb(4,"input",4),a.Rb("keyup",(function(t){return e.keyUp(t)})),a.Jb(),a.Kb(5,"button",5),a.Rb("click",(function(){return e.getCards()})),a.ec(6,"Pesquisar"),a.Jb(),a.Kb(7,"select",6),a.Kb(8,"option",7),a.ec(9,"Nome \u2191"),a.Jb(),a.Kb(10,"option",8),a.ec(11,"Nome \u2193"),a.Jb(),a.Kb(12,"option",9),a.ec(13,"Tipo \u2191"),a.Jb(),a.Kb(14,"option",10),a.ec(15,"Tipo \u2193"),a.Jb(),a.Jb(),a.Jb(),a.Ib(16,"br"),a.Kb(17,"div",11),a.Kb(18,"div",12),a.dc(19,M,12,5,"div",13),a.Jb(),a.Jb(),a.Jb()),2&t&&(a.xb(2),a.Wb("ngIf",e.loading),a.xb(2),a.Wb("formControl",e.search),a.xb(3),a.Wb("formControl",e.sortBy),a.xb(12),a.Wb("ngForOf",e.cardList))},directives:[b.j,f.a,f.h,f.d,f.l,f.j,f.n,b.i,b.k],styles:[".container[_ngcontent-%COMP%]{width:100%;height:calc(100vh - 130px);padding:20px;overflow:auto}.container-shadow[_ngcontent-%COMP%]{background:rgba(0,0,0,.4);margin-top:-20px;margin-left:-20px;position:absolute;display:flex;justify-content:center;align-items:center;font-weight:700;color:#fff;font-size:40px}.card-list[_ngcontent-%COMP%], .results[_ngcontent-%COMP%]{display:flex}.card-list[_ngcontent-%COMP%]{flex-direction:column;flex-grow:1;overflow:auto}.card-list-item[_ngcontent-%COMP%]{display:flex}.card-list-item[_ngcontent-%COMP%]   .card-list-item-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:10px;justify-content:center;flex-grow:1}.card-list-item[_ngcontent-%COMP%]   .card-list-item-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:700;display:inline-flex;width:50px}.card-move[_ngcontent-%COMP%], .card-to[_ngcontent-%COMP%]{width:56.61px!important;height:82.89px!important}"]}),t})();const A=["inputImportDeck"];function E(t,e){if(1&t){const t=a.Lb();a.Kb(0,"div",1),a.Kb(1,"h1"),a.ec(2),a.Jb(),a.Ib(3,"app-card-preview",2),a.Kb(4,"app-active-deck",3),a.Rb("cardHover",(function(e){return a.ac(t),a.Tb().cardPreview=e})),a.Jb(),a.Kb(5,"app-card-search-move",4),a.Rb("cardHover",(function(e){return a.ac(t),a.Tb().cardPreview=e}))("searchEvent",(function(e){return a.ac(t),a.Tb().searchEvent(e)})),a.Jb(),a.Jb()}if(2&t){const t=a.Tb();a.xb(2),a.fc(t.deck.name),a.xb(1),a.Wb("card",t.cardPreview),a.xb(1),a.Wb("deck",t.deck),a.xb(1),a.Wb("moveattribute",t.areaMoveAttribute)}}const J=[{path:"",component:(()=>{class t{constructor(t,e,i,n,r){this.ygoprodeckService=t,this.deckService=e,this.mygoService=i,this.router=n,this.route=r,this.modalSearch=!1,this.areaMoveAttribute="card-move-area",this.moveHandler=o(this.areaMoveAttribute)}ngOnInit(){this.route.params.pipe(Object(c.a)(1)).subscribe(t=>{t.deckId?(console.log(t.deckId),this.getDeck(t.deckId)):this.router.navigate(["/user/login"])})}getDeck(t){this.mygoService.deck(t).pipe(Object(c.a)(1)).subscribe(t=>{this.deck=t.deck,this.initMove()},t=>{alert(t.error.errors.join("|"))})}importDeck(){this.inputImportDeck.nativeElement.click()}handleInputDeck(t){const e=new FileReader;e.onload=t=>{},e.readAsText(t[0])}initMove(){setTimeout(()=>{this.moveHandler.initCardMove(this.moveHandler)},1e3)}searchEvent(t){this.initMove()}}return t.\u0275fac=function(e){return new(e||t)(a.Hb(s.a),a.Hb(d.a),a.Hb(l.a),a.Hb(n.b),a.Hb(n.a))},t.\u0275cmp=a.Bb({type:t,selectors:[["app-deck"]],viewQuery:function(t,e){var i;1&t&&a.ic(A,!0),2&t&&a.Zb(i=a.Sb())&&(e.inputImportDeck=i.first)},decls:1,vars:1,consts:[["class","active-deck",4,"ngIf"],[1,"active-deck"],[1,"active-deck-preview",3,"card"],[1,"active-deck-cards",3,"deck","cardHover"],[1,"active-deck-search",3,"moveattribute","cardHover","searchEvent"]],template:function(t,e){1&t&&a.dc(0,E,6,4,"div",0),2&t&&a.Wb("ngIf",e.deck)},directives:[b.j,u.a,v,w],styles:[".active-deck[_ngcontent-%COMP%]{display:flex}.active-deck-preview[_ngcontent-%COMP%]{width:300px}.active-deck-cards[_ngcontent-%COMP%], .active-deck-search[_ngcontent-%COMP%]{width:calc(50% - 150px)}"]}),t})(),canActivate:[r.a]}];let O=(()=>{class t{}return t.\u0275mod=a.Fb({type:t}),t.\u0275inj=a.Eb({factory:function(e){return new(e||t)},imports:[[n.d.forChild(J)],n.d]}),t})();var S=i("PCNd");let _=(()=>{class t{}return t.\u0275mod=a.Fb({type:t}),t.\u0275inj=a.Eb({factory:function(e){return new(e||t)},imports:[[S.a,O]]}),t})()}}]);